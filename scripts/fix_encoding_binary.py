#!/usr/bin/env python3
"""Fix encoding with binary replacement."""

# The corrupted sequence as bytes
CORRUPTED_ARROW = b'\xc3\x83\xc6\x92\xc3\x86\xe2\x80\x99\xc3\x83\xe2\x80\xa0\xc3\xa2\xe2\x82\xac\xe2\x84\xa2\xc3\x83\xc6\x92\xc3\xa2\xe2\x82\xac\xc5\xa1\xc3\x83\xe2\x80\x9a\xc3\x82\xc2\xa2\xc3\x83\xc6\x92\xc3\x86\xe2\x80\x99\xc3\x83\xe2\x80\x9a\xc3\x82\xc2\xa2\xc3\x83\xc6\x92\xc3\x82\xc2\xa2\xc3\x83\xc2\xa2\xc3\xa2\xe2\x82\xac\xc5\xa1\xc3\x82\xc2\xac\xc3\x83\xe2\x80\x9a\xc3\x82\xc2\xa0\xc3\x83\xc6\x92\xc3\x82\xc2\xa2\xc3\x83\xc2\xa2\xc3\xa2\xe2\x82\xac\xc5\xa1\xc3\x82\xc2\xac\xc3\x83\xc2\xa2\xc3\xa2\xe2\x82\xac\xc5\xbe\xc3\x82\xc2\xa2'
CORRUPTED_DASH = b'\xc3\x83\xc2\xa2\xc3\xa2\xe2\x82\xac\xc5\xa1\xc3\x82\xc2\xac\xc3\xa2\xe2\x82\xac\xc5\x93'
ASCII_ARROW = b'->'
ASCII_DASH = b'-'

# Read file as binary
with open('src/analysis/ar2_transitions.py', 'rb') as f:
    data = f.read()

print(f"File size: {len(data)} bytes")
print(f"Corrupted arrow sequences: {data.count(CORRUPTED_ARROW)}")
print(f"Corrupted dash sequences: {data.count(CORRUPTED_DASH)}")

# Replace
data = data.replace(CORRUPTED_ARROW, ASCII_ARROW)
data = data.replace(CORRUPTED_DASH, ASCII_DASH)

print(f"\nAfter replacement:")
print(f"Corrupted arrow sequences: {data.count(CORRUPTED_ARROW)}")
print(f"Corrupted dash sequences: {data.count(CORRUPTED_DASH)}")

# Write back
with open('src/analysis/ar2_transitions.py', 'wb') as f:
    f.write(data)

print("\nâœ“ File fixed successfully")
